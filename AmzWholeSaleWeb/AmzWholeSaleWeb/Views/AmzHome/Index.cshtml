@*@model IEnumerable<Kendo.Mvc.Examples.Models.ProductViewModel>*@
@model IEnumerable<AmzModel.AmzProduct>
@{
    ViewBag.Title = "AMZ";
}

@*<div class="jumbotron">
    <h1>AMZ Wholesale </h1>
    <p class="lead">
        We are dedicated to providing our customers with great deals, fast shipping, and excellent service.
        We sell a wide variety of items: housewares, home improvement supplies, pet food, clothing, carpets, and much more.  Our inventory is constantly expanding.  
        Please check in often for new great deals. 

        Register with us so that we can keep you upto date with all our lates deals and new supplies.

    </p>
 </div>*@


<div class="row">
    <button id="CartButton" type="button" onclick="addToCart()">Cart</button>
</div>
    @*<div class="row">*@
    @*<div class="col-md-4">
            <h2>Getting started</h2>
            <p>
                Write something about how your customers can benifit from buying your product. List some features of your comapny
                that are better than your competitors.

            </p>
            <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301865">Learn more &raquo;</a></p>
        </div>*@
    @*<div class="col-md-4">
            <h2>Get more libraries</h2>
            <p>NuGet is a free Visual Studio extension that makes it easy to add, remove, and update libraries and tools in Visual Studio projects.</p>
            <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301866">Learn more &raquo;</a></p>
        </div>
        <div class="col-md-4">
            <h2>Web Hosting</h2>
            <p>You can easily find a web hosting company that offers the right mix of features and price for your applications.</p>
            <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301867">Learn more &raquo;</a></p>
        </div>*@
    @*</div>*@

    <br />

    <div class="demo-section k-content wide">

        @(Html.Kendo().ListView<AmzModel.AmzProduct>(Model)
    .Name("listView")
    .TagName("div")
    .ClientTemplateId("template")
    .DataSource(dataSource => dataSource
        .Model(model => model.Id("ProductID"))
        .PageSize(99)
        //.Create(create => create.Action("Editing_Create", "ListView"))
        .Read(read => read.Action("Products_Read", "AmzHome"))
    //.Update(update => update.Action("Editing_Update", "ListView"))
    //.Destroy(destroy => destroy.Action("Editing_Destroy", "ListView"))
    ).Pageable().Editable().Navigatable().Selectable())
    </div>

    <script type="text/x-kendo-tmpl" id="template">
        <div class="product-view k-widget">
            <dl>
                <dt><img src="@Url.Content("~/content/products/")#:ProductID#.jpg" alt="#:ProductName# image" /> #:ProductDescription#</dt>
                <dd>#:ProductName#</dd>
                <dd>Price: #:kendo.toString(UnitPrice, "c")#</dd>
                <dd>In Stock: #:UnitsInStock#</dd>
            </dl>
            <div class="edit-buttons">
                <button id="addToCartButton" type="button" onclick="addToCart()">Add to cart</button>
            </div>
        </div>
    </script>

    <script>
        $(document).ready(function () {

            getCartCount();
            
        });

        function getCartCount()
        {
            var cartButton = document.getElementById("CartButton");
            var itemsInCart = 5;

            var parms = null;
            $.ajax({
                type: "GET",
                traditional: true,
                url: '@Url.Action("GetTotalItemsInCart", "AmzHome")',
                async: true,
                data: parms,
                dataType: "json",
                beforeSend: function (xhr) {
                },
                success: function (response, textStatus, jqXHR) {
                    //alert(response.message);
                    itemsInCart = response.Cart.TotalItems;
                    //alert(response.Cart.TotalItemsInCart);
                    //alert(itemsInCart);
                    cartButton.textContent = "Items in cart " + itemsInCart;
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) {
                    alert("Error found during execution");
                }
            });

          
        }

        $(function () {
            var listView = $("#listView").data("kendoListView");

            $(".k-add-button").click(function (e) {
                listView.add();
                e.preventDefault();
            });
        });

        $(document.body).keydown(function (e) {
            if (e.altKey && e.keyCode == 87) {
                $("#listView").focus();
            }
        });


        function addToCart() {
            alert("Add to cart")
        }
    </script>


    <style>
        .product-view {
            float: left;
            width: 33.3%;
            height: 300px;
            box-sizing: border-box;
            border-top: 0;
            position: relative;
        }

            .product-view img {
                float: left;
                width: 110px;
                height: 110px;
                opacity: 100;
                margin-bottom: 40px;
                margin-right: 10px;
            }

            .product-view:nth-child(even) {
                border-left-width: 0;
            }

            .product-view dl {
                margin: 10px 10px 0;
                padding: 0;
                overflow: hidden;
            }

            .product-view dt, dd {
                margin: 0;
                padding: 0;
                width: 100%;
                line-height: 24px;
                font-size: 18px;
            }

            .product-view dt {
                font-size: 14px;
                height: 16px;
                line-height: 16px;
                text-transform: none;
                opacity: 1;
                margin-left: 10px;
                word-wrap: break-word;
            }

            .product-view dd {
                height: 25px;
                overflow: hidden;
                white-space: nowrap;
                text-overflow: ellipsis;
            }

                .product-view dd .k-widget,
                .product-view dd .k-textbox {
                    font-size: 14px;
                }

        .k-listview {
            border-width: 1px 0 0;
            padding: 0;
            overflow: hidden;
            min-height: 298px;
        }

        .edit-buttons {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            text-align: right;
            padding: 5px;
            background-color: rgba(0,0,0,0.1);
        }

        .k-pager-wrap {
            border-top: 0;
        }

        span.k-invalid-msg {
            position: absolute;
            margin-left: 6px;
        }

        .k-add-button {
            margin-bottom: 2em;
        }

        @@media only screen and (max-width : 620px) {

            .product-view {
                width: 100%;
            }

                .product-view:nth-child(even) {
                    border-left-width: 1px;
                }
        }
    </style>
